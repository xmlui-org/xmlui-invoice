<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="xmlui/0.9.5.js"></script>
    <script src="xmlui/charts-0.1.12.js"></script>
    <script>
        window.xmluiHost = "http://localhost:8080"

        window.monthly_revenue = function () {
            const query = `
                select
                    substr(
                        'JanFebMarAprMayJunJulAugSepOctNovDec', -- A string containing all month abbreviations concatenated together
                        1 + 3 * (strftime('%m', issue_date) - 1), -- Calculate the starting position for extraction
                        -- Breaking down the position calculation:
                        -- strftime('%m', issue_date)     -- Extract month number (1-12)
                        -- strftime('%m', issue_date) - 1 -- Convert to 0-based index (0-11)
                        -- 3 * (...)                      -- Multiply by 3 because each abbreviation is 3 chars
                        -- 1 + ...                        -- Add 1 because SQLite substr is 1-indexed
                        3 -- Extract exactly 3 characters (the month abbreviation)
                    ) as month,
                    sum(total) as total
                from
                    invoices
                where
                    status = 'paid'
                group by
                    month
                order by
                    strftime('%m', issue_date)
            `
            return { sql: query }
        }
    </script>
</head>

<body></body>

</html>
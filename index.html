<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="xmlui/0.9.23.js"></script>
    <script src="xmlui/charts-0.1.21.js"></script>
    <script>
        // Helper functions
        window.coalesce = function (value, defaultValue = '') {
            return value ?? defaultValue;
        }

        window.formatMonth = function (month) {
            // Input: '2022-06'
            const [year, monthNum] = month.split('-');
            const date = new Date(year, monthNum - 1);
            return date.toLocaleString('default', { month: 'short', year: '2-digit' });
            // Output: 'Jun 22'
        }

        window.formatToday = function (plusDays = 0) {
            const date = new Date();
            if (plusDays !== 0) {
                date.setDate(date.getDate() + plusDays);
            }
            return date.toISOString().slice(0, 10).replace(/-/g, '/');
        }

        window.startDate = '2022-06-01'
        window.endDate = '2025-05-01'

        window.sliderValueToDate = function( value ) {
            console.log('sliderValueToDate', value)
            // Convert a slider value (representing days from start date) to an actual date string
            // value: number of days offset from startDate
            // returns: date string in YYYY-MM-DD format

            // Parse the global start date
            const start = new Date(window.startDate);

            // Create a new date by adding the slider value (days) to the start date
            const resultDate = new Date(start);
            resultDate.setDate(start.getDate() + value);

            // Format the date as YYYY-MM-DD
            const year = resultDate.getFullYear();
            const month = String(resultDate.getMonth() + 1).padStart(2, '0'); // +1 because months are 0-indexed
            const day = String(resultDate.getDate()).padStart(2, '0');

            const result =`${year}-${month}-${day}`;
            console.log('sliderValueToDate', result)
            return result
        }

        window.dateToSliderValue = function( dateString ) {
            // Convert a date string (YYYY-MM-DD) to a slider value (days from start date)
            // dateString: date in YYYY-MM-DD format
            // returns: number of days from the start date

            // Parse the input date and the global start date
            const date = new Date(dateString);
            const start = new Date(window.startDate);

            // Calculate the difference in days
            const diffTime = date.getTime() - start.getTime();
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));

            return diffDays;
        }

        window.dailyRevenueUrl = function(startDate, endDate, nonce) {
            // Returns the daily revenue API URL with query parameters
            return `/api/dashboard/daily-revenue?nonce=${encodeURIComponent(nonce)}&start_date=${encodeURIComponent(startDate)}&end_date=${encodeURIComponent(endDate)}`;
        }

    </script>

</head>

<body>
</body>

</html>